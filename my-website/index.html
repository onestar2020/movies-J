<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movies-J Official Site</title>

    <script>
      const appVersion = '2.1.0'; // Final sandbox fix version
    </script>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="images/logo.png" type="image/png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
 
    <script>
        document.write(`<link rel="stylesheet" href="css/home.css?v=${appVersion}">`);
    </script>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5209861049704399" crossorigin="anonymous"></script>
</head>

<body>
    <nav class="navbar">
        <div class="navbar-container">
            <img src="images/logo.png" alt="Movies-J Logo" class="logo-effect" />
            <div class="nav-links">
                <a href="index.html" class="active">Home</a>
                <a href="#">Movies</a>
                <a href="#">TV Shows</a>
                <a href="#">Anime</a>
            </div>
            <div class="nav-actions">
                <i class="fas fa-search" onclick="openSearchModal()"></i>
                <button class="watch-history-btn" title="Watch History" onclick="openWatchHistoryModal()">
                    <i class="fas fa-history"></i>
                </button>
                <button id="install-btn" style="display: none;" title="Install App">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
    </nav>

    <header class="hero-section" id="hero-section">
        <div class="hero-content">
            <h1 class="hero-title" id="hero-title">Loading Featured Movie...</h1>
            <p class="hero-description" id="hero-description"></p>
            <div class="hero-buttons">
                <button class="btn btn-primary" id="hero-watch-btn"><i class="fas fa-play"></i> Watch Now</button>
                <button class="btn btn-secondary" id="hero-info-btn"><i class="fas fa-info-circle"></i> More Info</button>
            </div>
        </div>
        <div class="hero-fade"></div>
    </header>

    <main class="main-container">
        <div class="row"><h2>Trending Movies</h2><div class="list" id="movies-list"></div></div>
        <div class="row"><h2>Trending TV Shows</h2><div class="list" id="tvshows-list"></div></div>
        <div class="row"><h2>Trending Anime</h2><div class="list" id="anime-list"></div></div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 Movies-J. All rights reserved.</p>
            <div class="footer-links">
                <a href="disclaimer.html">Disclaimer</a>
                <a href="about.html">About Us</a>
                <a href="contact.html">Contact Us</a>
            </div>
        </div>
    </footer>

    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="close" onclick="closeModal()">&times;</button>
            <div class="modal-body">
                <img id="modal-image" src="" alt="" />
                <div class="modal-text">
                    <div class="extra-section">
                        <h3 class="section-title">ðŸŽ­ Cast</h3><ul id="cast-list"></ul>
                        <h3 class="section-title">ðŸŽ¬ Similar Movies</h3><div id="similar-movies"></div>
                    </div>
                    <h2 id="modal-title"></h2>
                    <div class="stars" id="modal-rating"></div>
                    <p id="modal-description"></p>
                    <div id="tv-controls" style="margin-top: 10px;">
                        <div class="season-episode-selectors" style="display: none;">
                            <label for="season-selector">Season:</label><select id="season-selector"></select>
                            <label for="episode-selector">Episode:</label><select id="episode-selector"></select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="server-selector">
                <label for="server">Change Server:</label><select id="server" onchange="changeServer()"><option value="">Loading servers...</option></select>
                <p id="active-server-label"></p><p>âš  Ads shown in free movie servers are not controlled by this site.</p>
            </div>
            <iframe id="modal-video" width="100%" height="400" frameborder="0" allowfullscreen sandbox="allow-scripts allow-same-origin allow-presentation allow-forms allow-fullscreen allow-popups"></iframe>
        </div>
    </div>
    <div class="modal" id="upload-modal">
        <div class="modal-content">
            <button class="close" onclick="closeUploadModal()">&times;</button>
            <div class="modal-body" style="text-align: center;">
                <iframe id="upload-video" width="100%" height="400" frameborder="0" allowfullscreen sandbox="allow-scripts allow-same-origin allow-presentation allow-forms allow-fullscreen allow-popups"></iframe>
            </div>
            <div class="modal-text" style="text-align: center;">
                <h2 id="upload-title"></h2>
                <div class="stars" id="upload-rating"></div>
                <p id="upload-description"></p>
                <div>
                    <button id="upload-trailer-btn">ðŸŽ¬ Watch Trailer</button>
                    <button id="upload-watch-btn">â–¶ Watch Full Movie</button>
                    <a id="upload-download-btn" href="#" target="_blank" download><button>â¬‡ Download</button></a>
                </div>
                <p>âœ… Uploaded via Google Drive. No external ads included.</p>
            </div>
        </div>
    </div>
    <div class="search-modal" id="search-modal"><button class="close" onclick="closeSearchModal()">&times;</button><input type="text" id="search-input" placeholder="Search for a movie or show..." oninput="searchTMDB()" /><div class="results" id="search-results"></div></div>
    <div class="modal" id="watch-history-modal"><div class="modal-content" style="max-width: 600px; padding: 20px;"><span class="close" id="close-history-modal">&times;</span><h2>Watch History</h2><div id="watch-history-list" class="watch-history-list"></div></div></div>
    <div id="filemoon-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:9999; align-items:center; justify-content:center; flex-direction:column;">
        <button onclick="closeFilemoonModal()" style="position:absolute; top:10px; right:20px; background:#f44336; color:#fff; border:none; padding:10px 15px; border-radius:5px; font-weight:bold; cursor:pointer;">âœ– Close</button>
        <iframe id="filemoon-iframe" allow="autoplay; fullscreen" allowfullscreen referrerpolicy="no-referrer" style="width:90%; height:90%; border:none;" sandbox="allow-scripts allow-same-origin allow-presentation allow-forms allow-fullscreen allow-popups"></iframe>
    </div>

    <meta name="theme-color" content="#e50914">

    <script>
        const scripts = [
            'js/embed.js',
            'js/servers.js',
            'js/uploads.js',
            'js/home.js',
            'js/watchHistory.js',
            'pwa.js',
            'https://ssl.p.jwpcdn.com/player/v/8.36.6/jwplayer.js'
        ];
        scripts.forEach(src => {
            const script = document.createElement('script');
            // Lagyan lang ng version ang local files
            if (src.startsWith('js/') || src.startsWith('pwa.js')) {
                script.src = `${src}?v=${appVersion}`;
            } else {
                script.src = src; // Para sa external scripts tulad ng jwplayer
            }
            script.defer = true;
            document.body.appendChild(script);
        });
    </script>
    
    </body>
</html>